read_config: reading test/custom/Ultrasensitive.cfg
read_config: nice = 10
read_config: vmem = 750000
read_config: scoring_class = Ultrasensitive
read_config: work_dir = ultrasensitive
read_config: radius = 1
read_config: kf_max = 1e3
read_config: kf_min = 1e-3
read_config: kb_max = 1e3
read_config: kb_min = 1e-3
read_config: kp_max = 1e3
read_config: kp_min = 1e-3
read_config: regulated_concentration_width = 10
read_config: gene_unused_width = 4
read_config: regulated_concentration_max = 1e3
read_config: regulated_concentration_min = 1e-3
read_config: RT_transition_rate_width = 10
read_config: TR_transition_rate_width = 10
read_config: RT_phi_width = 10
read_config: domain_unused_width = 4
read_config: RT_transition_rate_max = 1e2
read_config: RT_transition_rate_min = 1e-2
read_config: TR_transition_rate_max = 1e2
read_config: TR_transition_rate_min = 1e-2
read_config: RT_phi_max = 1.0
read_config: RT_phi_min = 0.0
read_config: binding_profile_width = 8
read_config: kf_profile_width = 20
read_config: kb_profile_width = 20
read_config: kp_profile_width = 10
read_config: Keq_profile_width = 10
read_config: protodomain_unused_width = 4
read_config: Keq_ratio_max = 1e2
read_config: Keq_ratio_min = 1e-2
read_config: max_external_iterations = -1
read_config: max_internal_iterations = -1
read_config: max_complex_size = 4
read_config: max_species = 80
read_config: max_csite_bound_to_msite_number = 1
read_config: default_max_count = 2
read_config: default_steric_factor = 1e3
read_config: export_graphviz = [network,collapse_states,collapse_complexes]
read_config: solver = ode23s
read_config: sampling_interval = 1
read_config: SS_timescale = 500.0
read_config: InitialStep = 1e-8
read_config: AbsTol = 1e-9
read_config: RelTol = 1e-3
read_config: MaxStep = 500.0
read_config: plot_input = 1
read_config: plot_output = 1
read_config: plot_species = 0
read_config: plot_phase = 1
read_config: plot_min = -1
read_config: round_values_flag = 0
read_config: steady_state_threshold = 1000
read_config: steady_state_score_threshold = 0.5
read_config: delta_threshold = 0.01
read_config: amplitude_threshold = 0.01
read_config: ultrasensitivity_threshold = 5
read_config: w_n = 1.0
read_config: w_c = 0.1
read_config: w_a = 1.0
read_config: w_u = 1.0
read_config: w_u1 = 1.0
read_config: w_u3 = 0.1
read_config: LG_range = 10
read_config: LG_delay = ~
read_config: LG_strength = 4.0
read_config: LG_ramp_time = 3000
read_config: LG_steps = 3
read_config: LG_timeout = 20000
read_config: stimulus = ss_ramp_equation
read_config: hill_n = 40
read_config: hill_k = 5
read_config: TG_init = 1
read_config: cell_volume = 1e-18
read_config: lg_binding_profile = 01010011
read_config: tg_binding_profile = 10100011
MatlabDriver::START: starting matlab(98) on localhost (Thu Jun 14 12:01:23 EDT 2012)
MatlabDriver::START: logfile is test/custom/matlab/matlab.98.log
MatlabDriver::START: executing "ulimit -S -v 750000; ulimit -a; matlab -nodesktop -nosplash"
MatlabDriver::START: MATLAB shell pid=2955
{
  'Scoring' => {
                 'anc_ref' => {},
                 'config_file' => 'test/custom/Ultrasensitive.cfg',
                 'config_ref' => {
                                   'AbsTol' => '1e-9',
                                   'InitialStep' => '1e-8',
                                   'Keq_profile_width' => '10',
                                   'Keq_ratio_max' => '1e2',
                                   'Keq_ratio_min' => '1e-2',
                                   'LG_delay' => '~',
                                   'LG_ramp_time' => '3000',
                                   'LG_range' => '10',
                                   'LG_steps' => '3',
                                   'LG_strength' => '4.0',
                                   'LG_timeout' => '20000',
                                   'MaxStep' => '500.0',
                                   'RT_phi_max' => '1.0',
                                   'RT_phi_min' => '0.0',
                                   'RT_phi_width' => '10',
                                   'RT_transition_rate_max' => '1e2',
                                   'RT_transition_rate_min' => '1e-2',
                                   'RT_transition_rate_width' => '10',
                                   'RelTol' => '1e-3',
                                   'SS_timescale' => '500.0',
                                   'TG_init' => '1',
                                   'TR_transition_rate_max' => '1e2',
                                   'TR_transition_rate_min' => '1e-2',
                                   'TR_transition_rate_width' => '10',
                                   'amplitude_threshold' => '0.01',
                                   'binding_profile_width' => '8',
                                   'cell_volume' => '1e-18',
                                   'default_max_count' => '2',
                                   'default_steric_factor' => '1e3',
                                   'delta_threshold' => '0.01',
                                   'domain_unused_width' => '4',
                                   'export_graphviz' => [
                                                          'network',
                                                          'collapse_states',
                                                          'collapse_complexes'
                                                        ],
                                   'gene_unused_width' => '4',
                                   'hill_k' => '5',
                                   'hill_n' => '40',
                                   'kb_max' => '1e3',
                                   'kb_min' => '1e-3',
                                   'kb_profile_width' => '20',
                                   'kf_max' => '1e3',
                                   'kf_min' => '1e-3',
                                   'kf_profile_width' => '20',
                                   'kp_max' => '1e3',
                                   'kp_min' => '1e-3',
                                   'kp_profile_width' => '10',
                                   'lg_binding_profile' => '01010011',
                                   'max_complex_size' => '4',
                                   'max_csite_bound_to_msite_number' => '1',
                                   'max_external_iterations' => '-1',
                                   'max_internal_iterations' => '-1',
                                   'max_species' => '80',
                                   'nice' => '10',
                                   'plot_input' => '1',
                                   'plot_min' => '-1',
                                   'plot_output' => '1',
                                   'plot_phase' => '1',
                                   'plot_species' => '0',
                                   'protodomain_unused_width' => '4',
                                   'radius' => '1',
                                   'regulated_concentration_max' => '1e3',
                                   'regulated_concentration_min' => '1e-3',
                                   'regulated_concentration_width' => '10',
                                   'round_values_flag' => '0',
                                   'sampling_interval' => '1',
                                   'scoring_class' => 'Ultrasensitive',
                                   'solver' => 'ode23s',
                                   'steady_state_score_threshold' => '0.5',
                                   'steady_state_threshold' => '1000',
                                   'stimulus' => 'ss_ramp_equation',
                                   'tg_binding_profile' => '10100011',
                                   'ultrasensitivity_threshold' => '5',
                                   'vmem' => '750000',
                                   'w_a' => '1.0',
                                   'w_c' => '0.1',
                                   'w_n' => '1.0',
                                   'w_u' => '1.0',
                                   'w_u1' => '1.0',
                                   'w_u3' => '0.1',
                                   'work_dir' => 'ultrasensitive'
                                 },
                 'logfile' => 'matlab.98.log',
                 'matlab_ref' => bless( do{\(my $o = undef)}, 'MatlabDriver' ),
                 'matlab_work' => 'test/custom/matlab',
                 'node_ID' => 98,
                 'work_dir' => 'test/custom'
               }
};

read_config: reading test/custom/Ultrasensitive.cfg
read_config: nice = 10
read_config: vmem = 750000
read_config: scoring_class = Ultrasensitive
read_config: work_dir = ultrasensitive
read_config: radius = 1
read_config: kf_max = 1e3
read_config: kf_min = 1e-3
read_config: kb_max = 1e3
read_config: kb_min = 1e-3
read_config: kp_max = 1e3
read_config: kp_min = 1e-3
read_config: regulated_concentration_width = 10
read_config: gene_unused_width = 4
read_config: regulated_concentration_max = 1e3
read_config: regulated_concentration_min = 1e-3
read_config: RT_transition_rate_width = 10
read_config: TR_transition_rate_width = 10
read_config: RT_phi_width = 10
read_config: domain_unused_width = 4
read_config: RT_transition_rate_max = 1e2
read_config: RT_transition_rate_min = 1e-2
read_config: TR_transition_rate_max = 1e2
read_config: TR_transition_rate_min = 1e-2
read_config: RT_phi_max = 1.0
read_config: RT_phi_min = 0.0
read_config: binding_profile_width = 8
read_config: kf_profile_width = 20
read_config: kb_profile_width = 20
read_config: kp_profile_width = 10
read_config: Keq_profile_width = 10
read_config: protodomain_unused_width = 4
read_config: Keq_ratio_max = 1e2
read_config: Keq_ratio_min = 1e-2
read_config: max_external_iterations = -1
read_config: max_internal_iterations = -1
read_config: max_complex_size = 4
read_config: max_species = 80
read_config: max_csite_bound_to_msite_number = 1
read_config: default_max_count = 2
read_config: default_steric_factor = 1e3
read_config: export_graphviz = [network,collapse_states,collapse_complexes]
read_config: solver = ode23s
read_config: sampling_interval = 1
read_config: SS_timescale = 500.0
read_config: InitialStep = 1e-8
read_config: AbsTol = 1e-9
read_config: RelTol = 1e-3
read_config: MaxStep = 500.0
read_config: plot_input = 1
read_config: plot_output = 1
read_config: plot_species = 0
read_config: plot_phase = 1
read_config: plot_min = -1
read_config: round_values_flag = 0
read_config: steady_state_threshold = 1000
read_config: steady_state_score_threshold = 0.5
read_config: delta_threshold = 0.01
read_config: amplitude_threshold = 0.01
read_config: ultrasensitivity_threshold = 5
read_config: w_n = 1.0
read_config: w_c = 0.1
read_config: w_a = 1.0
read_config: w_u = 1.0
read_config: w_u1 = 1.0
read_config: w_u3 = 0.1
read_config: LG_range = 10
read_config: LG_delay = ~
read_config: LG_strength = 4.0
read_config: LG_ramp_time = 3000
read_config: LG_steps = 3
read_config: LG_timeout = 20000
read_config: stimulus = ss_ramp_equation
read_config: hill_n = 40
read_config: hill_k = 5
read_config: TG_init = 1
read_config: cell_volume = 1e-18
read_config: lg_binding_profile = 01010011
read_config: tg_binding_profile = 10100011
sequence=01111110100000000000001000000000010000000001111111111000000000110101000000000000000000001100000011000000100001111100111000000000000000000000000000000000000000000000000011111100111111001110000000000000000000000000000000000000010000111010111111001111110011101100000011000000100011110011101000000000000000000000000000000000000000000000000011111100111111001110000000000000000000000000000000000011100000111111001010101010000010000000001000000000000000000000001010011101011111100111111001110110000001100000010001111001110100100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001110000
Ultrasensitive::score_genome scoring genome Ultrasensitive
Ultrasensitive::score_genome scoring non-elite individual...
compute_high_order_adjacency_matrix: computing to order 12
compute_connectivity_matrix: computing
compute_high_order_adjacency_matrix: computing to order 8
compute_connectivity_matrix: computing
Protodomains: PD0057,PD0225,PD0454,LPD0057,TPD0057,TPD0057
Genes: G0000,G0397,LG0000,TG0000
prune_isolated_genes: pruned genes: 
LG is connected
TG is connected
LG protodomain connects to PD0057/0,PD0225/0,PD0454/0,LPD0057/0,TPD0057/0,TPD0057/1
TG/0 protodomain connects to PD0057/0,PD0225/0,PD0454/0,LPD0057/0,TPD0057/0,TPD0057/1
TG/1 protodomain connects to PD0057/0,PD0225/0,PD0454/0,LPD0057/0,TPD0057/0,TPD0057/1
TG/0 fans out to LG
TG/1 fans out to LG
LG fans out to TG/0
LG fans out to TG/1
find_adjacent_enzymes: PD0225 modifies (polarity=0) TPD0057
find_adjacent_enzymes: PD0454 modifies (polarity=1) TPD0057
Found 1 adjacent kinases
Found 1 adjacent phosphatases
TG has > 2 connected proteins
LG protein connects to G0000,G0397,LG0000,TG0000
TG protein connects to G0000,G0397,LG0000,TG0000
export_anc: created 5 rules
##############################################################################
# Allosteric Network Compiler (ANC)
# Copyright (C) 2005-2011 Julien Ollivier
# Author:       Julien F. Ollivier
# Version:      1.01
# Release Date: 2011/08/26
# This program comes with ABSOLUTELY NO WARRANTY.
# This is free software, and you are welcome to redistribute it
# under certain conditions. See file LICENSE.TXT for details.
##############################################################################

MODEL 	= test/custom/matlab/Ultrasensitive.mod
OUT 	= test/custom/matlab/Ultrasensitive.eqn
OUTDIR 	= test/custom/matlab

Start time: Thu Jun 14 12:01:26 EDT 2012
CLEANING UP
CREATING OUTPUT DIRECTORY
READING MODEL test/custom/matlab/Ultrasensitive.mod
REPORTING COMPILE PARAMETERS
max_external_iterations = -1
max_internal_iterations = -1
max_species = 80
max_complex_size = 4
max_csite_bound_to_msite_number = 1
kf_1st_order_rate_cutoff = 0
kf_2nd_order_rate_cutoff = 0
kb_rate_cutoff = 0
kp_rate_cutoff = 0
default_steric_factor = 1000
report = species
export_graphviz = network,collapse_states,collapse_complexes
compact_names = 1
protein_separator = _
IMPORTING COMPLEXES
COMPILING RULES
Compiling rule PD0057 LPD0057 (0 R 0 .) of class CanBindRule
PD0057 CanBind LPD0057
Compiling rule PD0057 LPD0057 (0 T 0 .) of class CanBindRule
PD0057 CanBind LPD0057
Compiling rule PD0225 TPD0057 (0 R 0 .) of class CanBindRule
PD0225 CanBind TPD0057
Compiling rule PD0225 TPD0057 (0 T 0 .) of class CanBindRule
PD0225 CanBind TPD0057
Compiling rule PD0454 TPD0057 (0 . 1 .) of class CanBindRule
PD0454 CanBind TPD0057
INSTANTIATING COMPLEXES
INITIALIZING INSTANCES
COMPILING REACTION NETWORK
ReactionNetwork::compile_network: starting...
ReactionNetwork::compile_network: STARTING INTERNAL iteration=1 total_species=4
ReactionNetwork::compile_network: STARTING EXTERNAL iteration=1 total_species=5
ReactionNetwork::compile_network: DONE EXTERNAL iteration=1 total_species=10
ReactionNetwork::compile_network: STARTING INTERNAL iteration=2 total_species=10
ReactionNetwork::compile_network: STARTING EXTERNAL iteration=2 total_species=10
ReactionNetwork::compile_external_reactions: processing species 5 of 10
ReactionNetwork::compile_network: DONE EXTERNAL iteration=2 total_species=13
ReactionNetwork::compile_network: STARTING INTERNAL iteration=3 total_species=13
ReactionNetwork::compile_network: STARTING EXTERNAL iteration=3 total_species=13
ReactionNetwork::compile_external_reactions: processing species 5 of 13
ReactionNetwork::compile_external_reactions: processing species 10 of 13
ReactionNetwork::compile_network: DONE EXTERNAL iteration=3 total_species=13
ReactionNetwork::compile_network: STARTING FINAL-INTERNAL total_species=13
ReactionNetwork::compile_network: DONE FINAL-INTERNAL total_species=13
ReactionNetwork::compile_network: Done computing species in 3 iterations
COMPILING ICs and STIMULI
Init Ic!00 comprises 1 objects:
	G0000R
Init Ic!01 comprises 1 objects:
	G0397
Init Ic!02 comprises 1 objects:
	LG0000
Init Ic!03 comprises 1 objects:
	TG00000
COMPILING PROBES
EXPORTING NETWORK
Facile->export(): generating Facile equation file
REPORTING SPECIES IN: test/custom/matlab/Ultrasensitive.species.rpt
EXPORTING NETWORK TO GRAPHVIZ
Start time: Thu Jun 14 12:01:26 EDT 2012
End time:   Thu Jun 14 12:01:26 EDT 2012
ANC NUM SPECIES: 13
facile_run: facile command is /home/ollivier/Project/facile/working/facile.pl  --matlab test/custom/matlab/Ultrasensitive.eqn
facile_run: started facile on Thu Jun 14 12:01:26 EDT 2012

Facile version 0.41
Copyright (c) 2003-2012, Ollivier, Siso, Swain et al.
Note: input files for Matlab sims are test/custom/matlab/Ultrasensitive_odes.m, test/custom/matlab/UltrasensitiveDriver.m, test/custom/matlab/Ultrasensitive_s.m, test/custom/matlab/Ultrasensitive_r.m, test/custom/matlab/Ultrasensitive_ode_event.m

facile_run: finished facile on Thu Jun 14 12:01:27 EDT 2012

ANC model complexity: 0 + 0 + 0 + 5
Ultrasensitive::score_genome: running matlab driver...
matlab_plot_complex: Figure 900 -- LG0000
matlab_plot_complex: Figure 901 -- TG00000
matlab_plot_complex: Figure 902 -- TG00001
RESULT VECTOR: INPUT = LG OUTPUT = TG00001 DELAY = ~
RESULT VECTOR:  t=47.00  input vector:         0 pos_output_vector: 0.909662 neg_output_vector: 0.0871309 (expected =        0)
RESULT VECTOR:  t=1152.00 input vector:     3.333 pos_output_vector: 0.907057 neg_output_vector: 0.0897552 (expected = 9.044e-08)
RESULT VECTOR:  t=2366.00 input vector:     6.667 pos_output_vector: 0.904449 neg_output_vector: 0.0923731 (expected =        1)
RESULT VECTOR:  t=3431.00 input vector:        10 pos_output_vector: 0.901876 neg_output_vector: 0.0949728 (expected =        1)
RESULT VECTOR:  t=4489.00 input vector:     6.667 pos_output_vector: 0.904454 neg_output_vector: 0.092399 (expected =        1)
RESULT VECTOR:  t=5596.00 input vector:     3.333 pos_output_vector: 0.907087 neg_output_vector: 0.0898128 (expected = 9.044e-08)
RESULT VECTOR:  t=6636.00 input vector:         0 pos_output_vector: 0.909711 neg_output_vector: 0.0871901 (expected =        0)
pos_output_select = 0
pos_delta = -0.00287930274483437, neg_delta = 0.0283874242624708
matlab_plot_phase: Figure 904 -- TG00000 vs LG0000
dy1_min/max = (8.713085599666191e-02, 8.975614856110345e-02) dy1n_min/max = (8.719008449502018e-02, 8.981277609757998e-02)
dy3_min/max = (9.237312478603710e-02, 9.497384015797491e-02) dy3n_min/max = (9.239839192099769e-02, 9.497276575552414e-02)
dy1 = 0.00262529256444154 dy2 = 0.00261790425827056 dy3 = 0.0026007153719378
dy1n = 0.0026226916025598 dy2n = 0.00258626203813757 dy3n=0.00257437383452644
score=0.0586426039509216, ANC_ok_flag=1, amplitude=0.00260208314820407, amplitude_score=0.00260208314820407, complexity=5, complexity_score=0.952380952380952, delta=0.0283874242624708, delta_score=0.739498020715695, max_mean_squared_err=1, mean_squared_err=0.356840005010797, mean_squared_err_score=0.0745875410248904, min_mean_squared_err=1e-06, network_connected_flag=1, network_connectivity=800, network_score=0.615384615384615, num_adjacent_kinases=1, num_adjacent_phosphatases=1, num_anc_species=13, num_genes=4, num_pruned_genes=0, num_reactions_tg_0=1, num_reactions_tg_1=4, parse_successful=1, score=0.0586426039509216, score_count=1, sim_flag=1, steady_state_score=0.464684014869888, tg_adjacent_genes=2, timeout_flag=0, ultrasensitivity_dy1=0.991650533004895, ultrasensitivity_dy3=1.00561866448748, ultrasensitivity_score=0.165680914728712
final_score = 0.0586426039509216 cumulative_score = 0.0586426039509216 count = 1
{
  'GenomeModel' => {
                     'elite_flag' => 0,
                     'history_ref' => [],
                     'score' => '0.0586426039509216',
                     'stats_ref' => {
                                      'ANC_ok_flag' => 1,
                                      'amplitude' => '0.00260208314820407',
                                      'amplitude_score' => '0.00260208314820407',
                                      'complexity' => 5,
                                      'complexity_score' => '0.952380952380952',
                                      'delta' => '0.0283874242624708',
                                      'delta_score' => '0.739498020715695',
                                      'max_mean_squared_err' => 1,
                                      'mean_squared_err' => '0.356840005010797',
                                      'mean_squared_err_score' => '0.0745875410248904',
                                      'min_mean_squared_err' => '1e-06',
                                      'network_connected_flag' => 1,
                                      'network_connectivity' => 800,
                                      'network_score' => '0.615384615384615',
                                      'num_adjacent_kinases' => 1,
                                      'num_adjacent_phosphatases' => 1,
                                      'num_anc_species' => 13,
                                      'num_genes' => 4,
                                      'num_pruned_genes' => 0,
                                      'num_reactions_tg_0' => 1,
                                      'num_reactions_tg_1' => 4,
                                      'parse_successful' => 1,
                                      'score' => '0.0586426039509216',
                                      'score_count' => 1,
                                      'sim_flag' => 1,
                                      'steady_state_score' => '0.464684014869888',
                                      'tg_adjacent_genes' => 2,
                                      'timeout_flag' => 0,
                                      'ultrasensitivity_dy1' => '0.991650533004895',
                                      'ultrasensitivity_dy3' => '1.00561866448748',
                                      'ultrasensitivity_score' => '0.165680914728712'
                                    }
                   },
  'Model' => {
               'parser_ref' => bless( do{\(my $o = undef)}, 'Genome' ),
               'sequence_ref' => bless( do{\(my $o = undef)}, 'Sequence' )
             },
  'Named' => {
               'name' => 'Ultrasensitive'
             }
};

Scoring::DEMOLISH: called
MatlabDriver::DEMOLISH: Closing matlab(98)
Scoring::DEMOLISH: done
